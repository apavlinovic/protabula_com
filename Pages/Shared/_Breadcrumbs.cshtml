@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@{
    var breadcrumbs = ViewData["Breadcrumbs"] as List<(string Label, string? Page, object? RouteValues)>;
    var culture = ViewContext.RouteData.Values["culture"]?.ToString() ?? "en";
}

@if (breadcrumbs != null && breadcrumbs.Count > 0)
{
    <nav class="breadcrumbs" aria-label="@Localizer["BreadcrumbLabel"]">
        <ol>
            <li>
                <a asp-page="/Index" asp-route-culture="@culture" aria-label="@Localizer["Home"]">
                    <svg class="breadcrumb-home-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                        <polyline points="9 22 9 12 15 12 15 22"/>
                    </svg>
                </a>
            </li>
            @for (var i = 0; i < breadcrumbs.Count; i++)
            {
                var crumb = breadcrumbs[i];
                var isLast = i == breadcrumbs.Count - 1;
                <li>
                    @if (isLast || crumb.Page == null)
                    {
                        <span aria-current="page">@crumb.Label</span>
                    }
                    else
                    {
                        <a asp-page="@crumb.Page" asp-all-route-data="@(crumb.RouteValues as IDictionary<string, string> ?? new Dictionary<string, string> { ["culture"] = culture })">@crumb.Label</a>
                    }
                </li>
            }
        </ol>
    </nav>
}
