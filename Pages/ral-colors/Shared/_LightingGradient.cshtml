@using Microsoft.AspNetCore.Mvc.Localization
@using protabula_com.Services
@model (IReadOnlyList<LightingVariation> LightingVariations, IReadOnlyList<DirectSunlightVariation> DirectSunlightVariations, string ColorNumber, string? ColorName)
@inject IViewLocalizer Localizer

@{
    var gradientStops = string.Join(", ", Model.LightingVariations.Select((v, i) =>
        $"{v.Hex} {i * 100 / (Model.LightingVariations.Count - 1)}%"));
    var sunlightGradientStops = string.Join(", ", Model.DirectSunlightVariations.Select((v, i) =>
        $"{v.Hex} {i * 100 / (Model.DirectSunlightVariations.Count - 1)}%"));
}

<section class="lighting-preview-section">
    <h2>@Localizer["LightingPreview", Model.ColorNumber, Model.ColorName ?? ""]</h2>
    <p class="text-secondary">@Localizer["LightingPreviewDesc"]</p>
    <div class="lighting-gradient-container">
        <div class="lighting-gradient" style="background: linear-gradient(to right, @gradientStops);"></div>
        <div class="lighting-labels">
            @foreach (var variation in Model.LightingVariations)
            {
                <div class="lighting-label-item">
                    <span class="lighting-time">@variation.Hour:00</span>
                </div>
            }
        </div>
    </div>
</section>

<hr>

<section class="direct-sunlight-section">
    <h2>@Localizer["DirectSunlight", Model.ColorNumber, Model.ColorName ?? ""]</h2>
    <p class="text-secondary">@Localizer["DirectSunlightDesc"]</p>
    <div class="lighting-gradient-container">
        <div class="lighting-gradient" style="background: linear-gradient(to right, @sunlightGradientStops);"></div>
        <div class="lighting-labels sunlight-labels">
            @foreach (var variation in Model.DirectSunlightVariations)
            {
                <div class="lighting-label-item">
                    <svg class="sun-icon sun-icon-@variation.CssClass" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 36 Q24 @(variation.Key == "Midday" ? "8" : "24") 44 36"
                            stroke="currentColor" stroke-width="1.5" stroke-dasharray="2 2" fill="none" opacity="0.4" />
                        <line x1="4" y1="36" x2="44" y2="36" stroke="currentColor" stroke-width="1.5" opacity="0.6" />
                        @if (variation.Key == "Morning")
                        {
                            <circle cx="12" cy="28" r="6" fill="#F59E0B" />
                            <g stroke="#F59E0B" stroke-width="1.5">
                                <line x1="12" y1="18" x2="12" y2="14" />
                                <line x1="4" y1="28" x2="0" y2="28" />
                                <line x1="6" y1="22" x2="3" y2="19" />
                            </g>
                        }
                        else if (variation.Key == "Midday")
                        {
                            <circle cx="24" cy="16" r="7" fill="#FBBF24" />
                            <g stroke="#FBBF24" stroke-width="1.5">
                                <line x1="24" y1="5" x2="24" y2="1" />
                                <line x1="24" y1="27" x2="24" y2="31" />
                                <line x1="13" y1="16" x2="9" y2="16" />
                                <line x1="35" y1="16" x2="39" y2="16" />
                                <line x1="16" y1="8" x2="13" y2="5" />
                                <line x1="32" y1="8" x2="35" y2="5" />
                                <line x1="16" y1="24" x2="13" y2="27" />
                                <line x1="32" y1="24" x2="35" y2="27" />
                            </g>
                        }
                        else
                        {
                            <circle cx="36" cy="28" r="6" fill="#F97316" />
                            <g stroke="#F97316" stroke-width="1.5">
                                <line x1="36" y1="18" x2="36" y2="14" />
                                <line x1="44" y1="28" x2="48" y2="28" />
                                <line x1="42" y1="22" x2="45" y2="19" />
                            </g>
                        }
                    </svg>
                    <span class="lighting-time">@Localizer[$"Sunlight{variation.Key}"]</span>
                </div>
            }
        </div>
    </div>
</section>
