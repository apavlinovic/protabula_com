@page "/ral-colors/{slug:regex(.*-vs-.*)}"
@using Microsoft.AspNetCore.Mvc.Localization
@using System.Globalization
@using protabula_com.Helpers
@using protabula_com.Models
@model VersusModel
@inject IViewLocalizer Localizer
@{
    var color1Title = Model.GetColor1Title();
    var color2Title = Model.GetColor2Title();

    // SEO-optimized title targeting "ral X vs Y" queries
    ViewData["Title"] = $"{color1Title} vs {color2Title} - {Localizer["TitleSuffix"].Value}";

    // Meta description with color codes
    var rgb1 = Model.Formats1?.Rgb ?? (byte.MinValue, byte.MinValue, byte.MinValue);
    var rgb2 = Model.Formats2?.Rgb ?? (byte.MinValue, byte.MinValue, byte.MinValue);
    ViewData["MetaDescription"] = Localizer["MetaDescription",
        Model.Color1.Number, Model.Color1.Name ?? "",
        Model.Color2.Number, Model.Color2.Name ?? "",
        Model.Color1.Hex, Model.Color2.Hex].Value;

    var currentCulture = CultureInfo.CurrentUICulture.Name;
    var request = ViewContext.HttpContext.Request;
    var baseUrl = $"{request.Scheme}://{request.Host}";

    ViewData["Breadcrumbs"] = new List<(string, string?, object?)>
    {
        (Localizer["BreadcrumbColors"].Value, "/ral-colors/Index", new Dictionary<string, string> { ["culture"] = currentCulture }),
        ($"{color1Title} vs {color2Title}", null, null)
    };
}

@section Head {
    <script type="application/ld+json">
    {
        "@@context": "https://schema.org",
        "@@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@@type": "ListItem",
                "position": 1,
                "name": "@Localizer["BreadcrumbHome"].Value",
                "item": "@baseUrl/@currentCulture"
            },
            {
                "@@type": "ListItem",
                "position": 2,
                "name": "@Localizer["BreadcrumbColors"].Value",
                "item": "@baseUrl/@currentCulture/ral-colors"
            },
            {
                "@@type": "ListItem",
                "position": 3,
                "name": "@color1Title vs @color2Title"
            }
        ]
    }
    </script>
}

<h1>@color1Title vs @color2Title</h1>

<p class="text-secondary mb-lg">
    @Localizer["Intro", Model.Color1.Number, Model.Color2.Number]
</p>

@{
    var autocomplete1 = new ColorAutocompleteModel(
        "colorSearch1",
        Localizer["SearchPlaceholder"].Value,
        Model.AllColors,
        Model.Color1.Number);
    var autocomplete2 = new ColorAutocompleteModel(
        "colorSearch2",
        Localizer["SearchPlaceholder"].Value,
        Model.AllColors,
        Model.Color2.Number);
}

<div class="versus-swatches-container">
    <div class="versus-swatches">
        <div class="versus-swatch-wrapper">
            <a asp-page="/ral-colors/Details" asp-route-culture="@currentCulture" asp-route-colorIdentifier="@Model.Color1.Slug"
               class="versus-swatch @(Model.Color1.NeedsDarkText ? "dark" : "")" style="background-color: @Model.Color1.Hex;">
                <span class="versus-swatch-number">RAL @Model.Color1.Number</span>
                @if (!string.IsNullOrEmpty(Model.Color1.Name))
                {
                    <span class="versus-swatch-name">@Model.Color1.Name</span>
                }
            </a>
            <div class="swatch-change-control">
                <button type="button" class="btn-change-color" onclick="toggleColorPicker(1)" aria-label="@Localizer["ChangeColor"]">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"/>
                    </svg>
                    @Localizer["ChangeColor"]
                </button>
                <div class="color-picker-dropdown" id="colorPicker1">
                    <partial name="Shared/_ColorAutocomplete" model="autocomplete1" />
                </div>
            </div>
        </div>
        <button type="button" class="btn-swap-colors" onclick="swapColors()" title="@Localizer["SwapColors"]">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m16 3 4 4-4 4"/>
                <path d="M20 7H4"/>
                <path d="m8 21-4-4 4-4"/>
                <path d="M4 17h16"/>
            </svg>
        </button>
        <div class="versus-swatch-wrapper">
            <a asp-page="/ral-colors/Details" asp-route-culture="@currentCulture" asp-route-colorIdentifier="@Model.Color2.Slug"
               class="versus-swatch @(Model.Color2.NeedsDarkText ? "dark" : "")" style="background-color: @Model.Color2.Hex;">
                <span class="versus-swatch-number">RAL @Model.Color2.Number</span>
                @if (!string.IsNullOrEmpty(Model.Color2.Name))
                {
                    <span class="versus-swatch-name">@Model.Color2.Name</span>
                }
            </a>
            <div class="swatch-change-control">
                <button type="button" class="btn-change-color" onclick="toggleColorPicker(2)" aria-label="@Localizer["ChangeColor"]">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"/>
                    </svg>
                    @Localizer["ChangeColor"]
                </button>
                <div class="color-picker-dropdown" id="colorPicker2">
                    <partial name="Shared/_ColorAutocomplete" model="autocomplete2" />
                </div>
            </div>
        </div>
    </div>
</div>

@{
    var hue1 = Model.Formats1?.Hsl.H ?? 0;
    var hue2 = Model.Formats2?.Hsl.H ?? 0;
    var sat1 = Model.Formats1?.Hsl.S ?? 0;
    var sat2 = Model.Formats2?.Hsl.S ?? 0;
    var light1 = Model.Formats1?.Hsl.L ?? 0;
    var light2 = Model.Formats2?.Hsl.L ?? 0;
    var lrv1 = Model.Formats1?.Lrv ?? 0;
    var lrv2 = Model.Formats2?.Lrv ?? 0;
    var cieL1 = Model.Formats1?.Lab.L ?? 0;
    var cieL2 = Model.Formats2?.Lab.L ?? 0;
    var cieA1 = Model.Formats1?.Lab.a ?? 0;
    var cieA2 = Model.Formats2?.Lab.a ?? 0;
    var cieB1 = Model.Formats1?.Lab.b ?? 0;
    var cieB2 = Model.Formats2?.Lab.b ?? 0;
}

<section class="versus-scenes mt-xl">
    <h2>@Localizer["SeeInContext"]</h2>
    <div class="scene-comparison-grid">
        @foreach (var scene in Model.Scenes)
        {
            var sceneKey = scene switch
            {
                "window" => "Window",
                "front-door" => "FrontDoor",
                "entrance" => "Entrance",
                "balcony" => "Balcony",
                "window-frame-detail" => "WindowFrameDetail",
                _ => scene
            };
            <div class="scene-comparison-row">
                <div class="scene-label">@Localizer[$"Scene{sceneKey}"]</div>
                <div class="scene-pair">
                    <a href="/images/ral-scenes/@(Model.Color1.Slug)-@(scene).jpg" target="_blank" class="scene-thumb-wrapper" style="background-color: @Model.Color1.Hex;">
                        <img src="/images/ral-scenes/@(Model.Color1.Slug)-@(scene).jpg" alt="RAL @Model.Color1.Number @(Model.Color1.Name ?? "") - @Localizer[$"Scene{sceneKey}"]" class="scene-thumb" loading="lazy" />
                    </a>
                    <a href="/images/ral-scenes/@(Model.Color2.Slug)-@(scene).jpg" target="_blank" class="scene-thumb-wrapper" style="background-color: @Model.Color2.Hex;">
                        <img src="/images/ral-scenes/@(Model.Color2.Slug)-@(scene).jpg" alt="RAL @Model.Color2.Number @(Model.Color2.Name ?? "") - @Localizer[$"Scene{sceneKey}"]" class="scene-thumb" loading="lazy" />
                    </a>
                </div>
            </div>
        }
    </div>
</section>

<section class="versus-comparison mt-xl">
    <h2>@Localizer["ColorComparison"]</h2>
    
    @{
        var hueFamily1 = ColorMath.GetHueColorFamily(hue1);
        var hueFamily2 = ColorMath.GetHueColorFamily(hue2);
        var color1Short = $"RAL {Model.Color1.Number}";
        var color2Short = $"RAL {Model.Color2.Number}";
    }
    <p class="comparison-summary">@Localizer["SummaryDeltaE", Model.DeltaE.ToString("F1"), Model.DeltaEInterpretation.ToLower()] @if (hueFamily1 == hueFamily2){@Localizer["SummaryHueFamilySame", hueFamily1]}else{@Localizer["SummaryHueFamily", color1Short, hueFamily1, color2Short, hueFamily2]} @if (Model.Temperature1.Classification == Model.Temperature2.Classification){@Localizer["SummaryTemperatureSame", Localizer[Model.Temperature1.Classification].Value.ToLower()]}else{@Localizer["SummaryTemperatureDiff", color1Short, Localizer[Model.Temperature1.Classification].Value.ToLower(), color2Short, Localizer[Model.Temperature2.Classification].Value.ToLower()]} @if (Math.Abs(lrv1 - lrv2) < 5){@Localizer["SummarySameBrightness", lrv1.ToString("F1"), lrv2.ToString("F1")]}else if (lrv1 > lrv2){@Localizer["SummaryBrighterColor", color1Short, lrv1.ToString("F1"), lrv2.ToString("F1"), color2Short]}else{@Localizer["SummaryBrighterColor", color2Short, lrv2.ToString("F1"), lrv1.ToString("F1"), color1Short]} @if (Math.Abs(sat1 - sat2) < 10){@Localizer["SummarySimilarSaturation"]}else if (sat1 > sat2){@Localizer["SummaryMoreSaturated", color1Short, sat1, color2Short, sat2]}else{@Localizer["SummaryMoreSaturated", color2Short, sat2, color1Short, sat1]}</p>

    <div class="delta-e-display">
        <div class="delta-e-header">
            <span class="delta-e-label">@Localizer["ColorDifference"] (Î”E)</span>
            <span class="delta-e-sublabel">@Localizer["DeltaEDescription"]</span>
        </div>
        <div class="delta-e-value">
            <span class="delta-e-number">@Model.DeltaE.ToString("F2")</span>
            <span class="delta-e-interpretation">@Model.DeltaEInterpretation</span>
        </div>
        <div class="delta-e-scale">
            <div class="delta-e-bar">
                <div class="delta-e-marker" style="left: @(Math.Min(Model.DeltaE / 20.0 * 100, 100))%;"></div>
            </div>
            <div class="delta-e-labels">
                <span>0</span>
                <span>5</span>
                <span>10</span>
                <span>20+</span>
            </div>
        </div>
    </div>

    <h3 class="table-title">@Localizer["ColorValues"]</h3>
    <div class="table-scroll-wrapper">
    <table class="color-details">
        <thead>
            <tr>
                <th></th>
                <th>@color1Title</th>
                <th>@color2Title</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th>
                    <span class="metric-header">
                        RGB
                        <span class="info-tooltip" tabindex="0">
                            <svg class="info-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                            <span class="tooltip-text">@Localizer["RgbTip"]</span>
                        </span>
                    </span>
                </th>
                <td>
                    <div class="color-value-list">
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#ff0000;"></span> Red</span> <span>@Model.Formats1?.Rgb.R</span></span>
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#00ff00;"></span> Green</span> <span>@Model.Formats1?.Rgb.G</span></span>
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#0000ff;"></span> Blue</span> <span>@Model.Formats1?.Rgb.B</span></span>
                    </div>
                </td>
                <td>
                    <div class="color-value-list">
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#ff0000;"></span> Red</span> <span>@Model.Formats2?.Rgb.R</span></span>
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#00ff00;"></span> Green</span> <span>@Model.Formats2?.Rgb.G</span></span>
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#0000ff;"></span> Blue</span> <span>@Model.Formats2?.Rgb.B</span></span>
                    </div>
                </td>
            </tr>
            <tr>
                <th>
                    <span class="metric-header">
                        CMYK
                        <span class="info-tooltip" tabindex="0">
                            <svg class="info-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                            <span class="tooltip-text">@Localizer["CmykTip"]</span>
                        </span>
                    </span>
                </th>
                <td>
                    <div class="color-value-list">
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#00ffff;"></span> Cyan</span> <span>@Model.Formats1?.Cmyk.C%</span></span>
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#ff00ff;"></span> Magenta</span> <span>@Model.Formats1?.Cmyk.M%</span></span>
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#ffff00;"></span> Yellow</span> <span>@Model.Formats1?.Cmyk.Y%</span></span>
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#000000;"></span> Key</span> <span>@Model.Formats1?.Cmyk.K%</span></span>
                    </div>
                </td>
                <td>
                    <div class="color-value-list">
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#00ffff;"></span> Cyan</span> <span>@Model.Formats2?.Cmyk.C%</span></span>
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#ff00ff;"></span> Magenta</span> <span>@Model.Formats2?.Cmyk.M%</span></span>
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#ffff00;"></span> Yellow</span> <span>@Model.Formats2?.Cmyk.Y%</span></span>
                        <span class="color-value-row"><span class="color-dot-label"><span class="color-dot" style="background:#000000;"></span> Key</span> <span>@Model.Formats2?.Cmyk.K%</span></span>
                    </div>
                </td>
            </tr>
            <tr>
                <th>
                    <span class="metric-header">
                        @Localizer["Hue"]
                        <span class="info-tooltip" tabindex="0">
                            <svg class="info-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                            <span class="tooltip-text">@Localizer["HueTip"]</span>
                        </span>
                    </span>
                </th>
                <td>
                    <partial name="Shared/_HueDiagram" model="hue1" />
                </td>
                <td>
                    <partial name="Shared/_HueDiagram" model="hue2" />
                </td>
            </tr>
            <tr>
                <th>
                    <span class="metric-header">
                        @Localizer["Saturation"]
                        <span class="info-tooltip" tabindex="0">
                            <svg class="info-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                            <span class="tooltip-text">@Localizer["SaturationTip"]</span>
                        </span>
                    </span>
                </th>
                <td><partial name="Shared/_SaturationBar" model="new SaturationBarModel(hue1, sat1)" /></td>
                <td><partial name="Shared/_SaturationBar" model="new SaturationBarModel(hue2, sat2)" /></td>
            </tr>
            <tr>
                <th>
                    <span class="metric-header">
                        @Localizer["Lightness"]
                        <span class="info-tooltip" tabindex="0">
                            <svg class="info-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                            <span class="tooltip-text">@Localizer["LightnessTip"]</span>
                        </span>
                    </span>
                </th>
                <td><partial name="Shared/_LightnessBar" model="new LightnessBarModel(hue1, light1)" /></td>
                <td><partial name="Shared/_LightnessBar" model="new LightnessBarModel(hue2, light2)" /></td>
            </tr>
            <tr>
                <th>
                    <span class="metric-header">
                        @Localizer["LRV"]
                        <span class="info-tooltip" tabindex="0">
                            <svg class="info-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                            <span class="tooltip-text">@Localizer["LrvTip"]</span>
                        </span>
                    </span>
                </th>
                <td><partial name="Shared/_LrvBar" model="new LrvBarModel(lrv1)" /></td>
                <td><partial name="Shared/_LrvBar" model="new LrvBarModel(lrv2)" /></td>
            </tr>
            <tr>
                <th>
                    <span class="metric-header">
                        @Localizer["CieL"]
                        <span class="info-tooltip" tabindex="0">
                            <svg class="info-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                            <span class="tooltip-text">@Localizer["CieLTip"]</span>
                        </span>
                    </span>
                </th>
                <td><partial name="Shared/_CieLabBar" model="@(new CieLabComponentModel("L", cieL1))" /></td>
                <td><partial name="Shared/_CieLabBar" model="@(new CieLabComponentModel("L", cieL2))" /></td>
            </tr>
            <tr>
                <th>
                    <span class="metric-header">
                        @Localizer["CieA"]
                        <span class="info-tooltip" tabindex="0">
                            <svg class="info-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                            <span class="tooltip-text">@Localizer["CieATip"]</span>
                        </span>
                    </span>
                </th>
                <td><partial name="Shared/_CieLabBar" model="@(new CieLabComponentModel("a", cieA1))" /></td>
                <td><partial name="Shared/_CieLabBar" model="@(new CieLabComponentModel("a", cieA2))" /></td>
            </tr>
            <tr>
                <th>
                    <span class="metric-header">
                        @Localizer["CieB"]
                        <span class="info-tooltip" tabindex="0">
                            <svg class="info-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                            <span class="tooltip-text">@Localizer["CieBTip"]</span>
                        </span>
                    </span>
                </th>
                <td><partial name="Shared/_CieLabBar" model="@(new CieLabComponentModel("b", cieB1))" /></td>
                <td><partial name="Shared/_CieLabBar" model="@(new CieLabComponentModel("b", cieB2))" /></td>
            </tr>
            <tr>
                <th>
                    <span class="metric-header">
                        @Localizer["ColorTemperature"]
                        <span class="info-tooltip" tabindex="0">
                            <svg class="info-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                            <span class="tooltip-text">@Localizer["TemperatureTip"]</span>
                        </span>
                    </span>
                </th>
                <td><partial name="Shared/_TemperatureBadge" model="new TemperatureBadgeModel(Model.Temperature1.Kelvin, Model.Temperature1.Classification)" /></td>
                <td><partial name="Shared/_TemperatureBadge" model="new TemperatureBadgeModel(Model.Temperature2.Kelvin, Model.Temperature2.Classification)" /></td>
            </tr>
        </tbody>
    </table>
    </div>
</section>

<section class="learn-metrics-section mt-xl">
    <h2>@Localizer["LearnMetrics"]</h2>
    <p class="learn-metrics-intro">@Localizer["LearnMetricsIntro"]</p>
    <button type="button" class="learn-metrics-toggle" aria-expanded="false" aria-controls="learn-metrics-content" onclick="this.setAttribute('aria-expanded', this.getAttribute('aria-expanded') === 'false' ? 'true' : 'false'); document.getElementById('learn-metrics-content').classList.toggle('expanded');">
        <span>Show definitions</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
    </button>
    <div id="learn-metrics-content" class="learn-metrics-content">
        <div class="metric-definition">
            <h3>@Localizer["LearnHue"]</h3>
            <p>@Localizer["LearnHueDesc"]</p>
        </div>
        <div class="metric-definition">
            <h3>@Localizer["LearnSaturation"]</h3>
            <p>@Localizer["LearnSaturationDesc"]</p>
        </div>
        <div class="metric-definition">
            <h3>@Localizer["LearnLightness"]</h3>
            <p>@Localizer["LearnLightnessDesc"]</p>
        </div>
        <div class="metric-definition">
            <h3>@Localizer["LearnLrv"]</h3>
            <p>@Localizer["LearnLrvDesc"]</p>
        </div>
        <div class="metric-definition">
            <h3>@Localizer["LearnCieL"]</h3>
            <p>@Localizer["LearnCieLDesc"]</p>
        </div>
        <div class="metric-definition">
            <h3>@Localizer["LearnCieA"]</h3>
            <p>@Localizer["LearnCieADesc"]</p>
        </div>
        <div class="metric-definition">
            <h3>@Localizer["LearnCieB"]</h3>
            <p>@Localizer["LearnCieBDesc"]</p>
        </div>
        <div class="metric-definition">
            <h3>@Localizer["LearnTemperature"]</h3>
            <p>@Localizer["LearnTemperatureDesc"]</p>
        </div>
    </div>
</section>

<section class="versus-links mt-xl">
    <h2>@Localizer["ViewDetails"]</h2>
    <div class="versus-link-buttons">
        <a asp-page="/ral-colors/Details" asp-route-culture="@currentCulture" asp-route-colorIdentifier="@Model.Color1.Slug" class="btn btn-secondary btn-with-swatch">
            <span class="btn-swatch" style="background-color: @Model.Color1.Hex;"></span>
            @Localizer["ViewColor", Model.Color1.Number]
        </a>
        <a asp-page="/ral-colors/Details" asp-route-culture="@currentCulture" asp-route-colorIdentifier="@Model.Color2.Slug" class="btn btn-secondary btn-with-swatch">
            <span class="btn-swatch" style="background-color: @Model.Color2.Hex;"></span>
            @Localizer["ViewColor", Model.Color2.Number]
        </a>
    </div>
    <p class="mt-md">
        <a asp-page="/ral-colors/Compare" asp-route-culture="@currentCulture" class="text-link">
            @Localizer["CompareMore"] &rarr;
        </a>
    </p>
</section>

<a asp-page="/ral-colors/Index" class="btn btn-ghost mt-xl" asp-route-culture="@RouteData.Values["culture"]">
    &larr; @Localizer["BackToColors"]
</a>

@section Scripts {
    <script src="~/js/color-autocomplete.js" asp-append-version="true"></script>
    <script>
        const currentCulture = '@currentCulture';
        const color1Slug = '@Model.Color1.Slug';
        const color2Slug = '@Model.Color2.Slug';

        // Convert color number to URL-friendly slug (spaces to underscores)
        function toSlug(colorNumber) {
            return colorNumber.replace(/ /g, '_');
        }

        // Navigate to new versus URL
        function navigateToVersus(slug1, slug2) {
            window.location.href = `/${currentCulture}/ral-colors/${slug1}-vs-${slug2}`;
        }

        // Toggle color picker dropdown
        function toggleColorPicker(which) {
            const picker = document.getElementById(`colorPicker${which}`);
            const otherPicker = document.getElementById(`colorPicker${which === 1 ? 2 : 1}`);

            // Close the other picker
            otherPicker.classList.remove('active');

            // Toggle this picker
            picker.classList.toggle('active');

            if (picker.classList.contains('active')) {
                const input = picker.querySelector('.autocomplete-input');
                if (input) {
                    input.focus();
                }
            }
        }

        // Swap colors
        function swapColors() {
            navigateToVersus(color2Slug, color1Slug);
        }

        // Close pickers when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.swatch-change-control')) {
                document.querySelectorAll('.color-picker-dropdown').forEach(p => p.classList.remove('active'));
            }
        });

        // Initialize autocompletes
        initColorAutocomplete('colorSearch1', function(number, hex, name) {
            const newSlug = toSlug(number);
            if (newSlug !== color1Slug) {
                navigateToVersus(newSlug, color2Slug);
            }
        });

        initColorAutocomplete('colorSearch2', function(number, hex, name) {
            const newSlug = toSlug(number);
            if (newSlug !== color2Slug) {
                navigateToVersus(color1Slug, newSlug);
            }
        });
    </script>
}
